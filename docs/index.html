<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CAAL Tool Registry</title>
  <style>
    :root {
      --bg: #0d1117;
      --card-bg: #161b22;
      --border: #30363d;
      --text: #c9d1d9;
      --text-muted: #8b949e;
      --accent: #58a6ff;
      --gold: #ffd700;
      --silver: #c0c0c0;
      --warning: #d29922;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 8px;
    }

    .tagline {
      color: var(--text-muted);
      font-size: 1.1rem;
    }

    .tagline a {
      color: var(--accent);
      text-decoration: none;
    }

    .tagline a:hover {
      text-decoration: underline;
    }

    .search-container {
      margin-bottom: 30px;
    }

    .search {
      width: 100%;
      padding: 14px 18px;
      font-size: 16px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      outline: none;
    }

    .search:focus {
      border-color: var(--accent);
    }

    .search::placeholder {
      color: var(--text-muted);
    }

    .filters {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .filter-btn {
      padding: 6px 14px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 20px;
      color: var(--text-muted);
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-btn:hover,
    .filter-btn.active {
      border-color: var(--accent);
      color: var(--accent);
    }

    .stats {
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 20px;
    }

    .tools {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .tool {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
      transition: border-color 0.2s;
    }

    .tool:hover {
      border-color: var(--accent);
    }

    .tool-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .tool-name {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--accent);
      text-decoration: none;
    }

    .tool-name:hover {
      text-decoration: underline;
    }

    .tier {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      text-transform: uppercase;
    }

    .tier-verified {
      background: var(--gold);
      color: #000;
    }

    .tier-community {
      background: var(--silver);
      color: #000;
    }

    .tier-experimental {
      background: var(--warning);
      color: #000;
    }

    .tool-description {
      color: var(--text);
      margin-bottom: 12px;
    }

    .tool-trigger {
      color: var(--text-muted);
      font-style: italic;
      font-size: 14px;
      margin-bottom: 12px;
    }

    .tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .tag {
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .tag.category {
      border-color: var(--accent);
      color: var(--accent);
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
    }

    .empty-state h3 {
      margin-bottom: 10px;
      color: var(--text);
    }

    .empty-state a {
      color: var(--accent);
    }

    footer {
      text-align: center;
      margin-top: 60px;
      padding-top: 30px;
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: 14px;
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>CAAL Tool Registry</h1>
      <p class="tagline">Voice-first workflows for <a href="https://github.com/CoreWorxLab/caal">CAAL</a></p>
    </header>

    <div class="search-container">
      <input type="text" class="search" placeholder="Search tools..." id="search" autofocus>
    </div>

    <div class="filters" id="filters">
      <button class="filter-btn active" data-category="all">All</button>
      <button class="filter-btn" data-category="smart-home">Smart Home</button>
      <button class="filter-btn" data-category="media">Media</button>
      <button class="filter-btn" data-category="homelab">Homelab</button>
      <button class="filter-btn" data-category="productivity">Productivity</button>
      <button class="filter-btn" data-category="utilities">Utilities</button>
      <button class="filter-btn" data-category="social">Social</button>
      <button class="filter-btn" data-category="other">Other</button>
    </div>

    <div class="stats" id="stats"></div>

    <div class="tools" id="tools"></div>

    <footer>
      <p>
        <a href="https://github.com/CoreWorxLab/caal-tools">Contribute a tool</a> &middot;
        <a href="https://github.com/CoreWorxLab/caal">Get CAAL</a> &middot;
        <a href="https://github.com/CoreWorxLab/caal-tools/issues/new?template=tool-request.md">Request a tool</a>
      </p>
    </footer>
  </div>

  <script>
    let allTools = [];
    let currentCategory = 'all';

    fetch('index.json')
      .then(r => r.json())
      .then(tools => {
        allTools = tools;
        render(tools);
        updateStats(tools);
      })
      .catch(() => {
        document.getElementById('tools').innerHTML = `
          <div class="empty-state">
            <h3>No tools yet</h3>
            <p>Be the first to <a href="https://github.com/CoreWorxLab/caal-tools/blob/main/CONTRIBUTING.md">contribute a tool</a>!</p>
          </div>
        `;
        document.getElementById('stats').textContent = '0 tools available';
      });

    document.getElementById('search').addEventListener('input', (e) => {
      filterAndRender();
    });

    document.getElementById('filters').addEventListener('click', (e) => {
      if (e.target.classList.contains('filter-btn')) {
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        e.target.classList.add('active');
        currentCategory = e.target.dataset.category;
        filterAndRender();
      }
    });

    function filterAndRender() {
      const q = document.getElementById('search').value.toLowerCase();
      let filtered = allTools;

      if (currentCategory !== 'all') {
        filtered = filtered.filter(t => t.category === currentCategory);
      }

      if (q) {
        filtered = filtered.filter(t =>
          t.name.includes(q) ||
          t.description.toLowerCase().includes(q) ||
          t.tags.some(tag => tag.includes(q)) ||
          t.voice_triggers.some(vt => vt.toLowerCase().includes(q))
        );
      }

      render(filtered);
      updateStats(filtered);
    }

    function updateStats(tools) {
      const total = allTools.length;
      const showing = tools.length;
      if (total === 0) {
        document.getElementById('stats').textContent = '0 tools available';
      } else if (showing === total) {
        document.getElementById('stats').textContent = `${total} tool${total === 1 ? '' : 's'} available`;
      } else {
        document.getElementById('stats').textContent = `Showing ${showing} of ${total} tools`;
      }
    }

    function render(tools) {
      const container = document.getElementById('tools');

      if (tools.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <h3>No tools found</h3>
            <p>Try a different search or <a href="https://github.com/CoreWorxLab/caal-tools/issues/new?template=tool-request.md">request this tool</a>!</p>
          </div>
        `;
        return;
      }

      container.innerHTML = tools.map(t => `
        <div class="tool">
          <div class="tool-header">
            <a href="https://github.com/CoreWorxLab/caal-tools/tree/main/${t.path}" class="tool-name">${t.name}</a>
            <span class="tier tier-${t.tier}">${t.tier}</span>
          </div>
          <p class="tool-description">${escapeHtml(t.description)}</p>
          ${t.voice_triggers[0] ? `<p class="tool-trigger">"Hey Cal, ${escapeHtml(t.voice_triggers[0])}"</p>` : ''}
          <div class="tags">
            <span class="tag category">${t.category}</span>
            ${t.required_services.map(s => `<span class="tag">${escapeHtml(s)}</span>`).join('')}
          </div>
        </div>
      `).join('');
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  </script>
</body>
</html>
